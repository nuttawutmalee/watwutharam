webpackJsonp([8],{1005:function(t,e){t.exports='<div class="page-detail-wrapper no-style" [ngClass]="{ \'edit-mode\': _editMode }">\r\n    <table id="tblGlobalItems" di-datatable class="module-table" data-table-module="global"></table>\r\n</div>\r\n\r\n<div class="go-back-btn" [ngClass]="{ \'edit-mode\': _editMode }" (click)="closeEditMode()">\r\n\t<i class="material-icons">keyboard_arrow_left</i>\r\n</div>\r\n\r\n<div class="page-detail-edit-mode" [ngClass]="{ \'edit-mode\': _editMode }">\r\n    <cmp-content-translation-editor (onReady)="onEditModeReady()" (onComponentWorking)="isBusy = $event;" (onDataSaved)="closeEditMode()"></cmp-content-translation-editor>\r\n</div>\r\n\r\n<div class="component-busy" [hidden]="!isBusy" >\r\n\t<span input-loader [size]="\'32px\'"></span>\r\n</div>'},941:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(984);n.d(e,"GlobalsContentModule",(function(){return i.a}))},951:function(t,e,n){"use strict";var i=n(19),a=n(26),o=n(12),s=n(35);n.d(e,"a",(function(){return r}));var r=(function(){function t(t){this._inj=t,this._pageTitle="",this._siteList=[],this._reqSvc=this._inj.get(i.a),this._router=this._inj.get(a.c),this._cmn=this._inj.get(o.a),this._dlg=this._inj.get(s.a)}return t.prototype.ngOnInit=function(){this._cmn.setInfo({navList:[]})},t.prototype.ngOnDestroy=function(){},t})()},952:function(t,e){t.exports='<div class="cmp-container">\r\n\t<router-outlet></router-outlet>\r\n</div>\r\n'},953:function(t,e,n){"use strict";var i=n(4),a=n(2),o=n(16),s=n(91),r=n(9),l=n(73),c=n(92),d=n(26),u=n(93),p=n(169),m=n(0),g=(n.n(m),n(423)),b=n(43),_=n(27);n.d(e,"a",(function(){return f}));var f=(function(t){function e(e,n,i,a,o,s,l){var d=t.call(this,e)||this;d._acRoute=n,d.el=i,d._router=a,d._zone=o,d._storageSvc=s,d._translate=l,d.siteLanguages=[],d._itemList=[],d._propItemList=[],d._editMode=!1,d.translationList=[],d.isBusy=!0,d._pageItemDetail=[],d.itemElementOption={textEditorOptions:Object.assign({},r.m.contentTextEditorOptions,{height:400})},d.currentLangName="",d.currentLang="",d._currentSiteId="",d._originalData="",d._orderChanged=!1,d._pageId="",d.loadComplete=!1,d._tableOptions={afterInitTable:function(t){d.afterInitTable(t)},afterDraw:function(t){d.tableEventBinding(t),"function"==typeof d.customAfterTableDraw&&d.customAfterTableDraw(t)}},d._globalItemList=[],d._showHiddenValue=!1,d.selectedGlobalItemId="",d.backToPageId="",d._elem.addClass("component-wrapper"),d._cmn.setInfo({topBarButtonList:[],navList:[],pageTitle:"app_nav.global_item"}),d._infoSubscription=d._cmn.getInfo().subscribe((function(t){if(t.currentSiteId!==d._currentSiteId&&(d._currentSiteId=t.currentSiteId,d.contentTransEditorCmp.setSiteId(d._currentSiteId),d.loadComplete=!1,d.isBusy=!0,d.getSiteLanguages()),t.customTrigger&&"GLOBAL_ITEM"===t.customTrigger&&(d.selectedGlobalItemId=window.sessionStorage.getItem("tmp-selected-id")||"",window.sessionStorage.removeItem("tmp-selected-id"),d.selectedGlobalItemId)){var e=d._globalItemList.filter((function(t){return t.id===d.selectedGlobalItemId}));e.length&&d.openEditMode(e[0])}d._showHiddenValue=[r.c.DEVELOPER].indexOf(t.currentUserLevel)>-1}));var p=d._cmn.getComponentFactory(["[cmp-property-editor]","[cmp-control-list-manager]"]);return p["[cmp-property-editor]"]?d._propEditCmpFactory=p["[cmp-property-editor]"]:d._propEditCmpFactory=d._resolver.resolveComponentFactory(u.a),p["[cmp-control-list-manager]"]?d._ctlListManagerCmpFactory=p["[cmp-control-list-manager]"]:d._ctlListManagerCmpFactory=d._resolver.resolveComponentFactory(c.a),d.selectedGlobalItemId=window.sessionStorage.getItem("tmp-selected-id")||"",window.sessionStorage.removeItem("tmp-selected-id"),d}return i.a(e,t),e.prototype.ngOnInit=function(){this._elem.closest(".cmp-container").addClass("full-expand"),this.backToPageId=window.sessionStorage.getItem("tmp-back-to-page-id")||"",window.sessionStorage.removeItem("tmp-back-to-page-id")},e.prototype.ngOnDestroy=function(){this._infoSubscription.unsubscribe()},e.prototype.loadGlobalItems=function(){var t=this,e=Object.assign({},o.a.url.sites.getSiteGlobals);e.url=e.url.replace(/(:id)/g,this._currentSiteId),this._translate.get(["common.filter_global_by_category_label","common.filter_all"]).subscribe((function(n){t.translationList=n,t._req.doRequest(e).subscribe((function(e){var n=t;t.isBusy=!1;var i=Object.assign([],e.data);e.result&&(t._itemList=i.filter((function(t){return t.is_active})));var a=i.filter((function(t){return t.is_active}));t._showHiddenValue||(a=a.filter((function(t){return t.is_visible}))),a.map((function(t){t.element_type!==r.p.TEXTBOX||/^(\{|\[)/g.test(t.element_value)||(t.element_value='{ "helper":"" }')})),t._globalItemList=Object.assign([],a),t.loadComplete||(t.loadComplete=!0);var o={data:a,columns:[{data:"name",title:"Item Name",width:"400px",render:function(t,e,n){if(n.hasOwnProperty("count_page_items")){var i=n.count_page_items;if(i>0)return 1===i?t+"<br><small>(Used by "+i+" page items)</small>":t+"<br><small>(Used by "+i+" page item)</small>"}return t}},{data:"categories",visible:!1},{title:"",width:"150px",orderable:!1,searchable:!1,render:function(t,e,n){return'<div class="table-icon-wrapper"><a class="table-item-icon" role="edit" aria-function="edit-item" data-item-id="'+n.id+'"><i class="material-icons">edit</i></a></div>'}}],afterInitTable:function(t){var e=t.DataTable().column("1"),i=t.DataTable().table().container(),o=[];if(a.length>0&&(a.forEach((function(t){t.hasOwnProperty("categories")&&o.push.apply(o,t.categories)})),o=$.unique(o)),o.length>0){var s='<div class="col-xs-12 col-md-6 col-lg-6 filter-bar submission-filter-bar"><div class="dataTables_length"><label>'+n.translationList["common.filter_global_by_category_label"]+'<select class="form-control form-control-sm col-10 submission-type-select" size="0"><option value="">'+n.translationList["common.filter_all"]+"</option>";o.forEach((function(t){s+='<option value="'+t+'">'+t+"</option>"})),s+="</select></label></div></div>",$(i).prepend(s),$("select.submission-type-select").on("change",(function(t){var n=$.fn.dataTable.util.escapeRegex($(t.currentTarget).val());e.search(n).draw()}))}else $(".submission-filter-bar").remove()}};t.initTable(o),setTimeout((function(){if(t.selectedGlobalItemId){var e=a.filter((function(e){return e.id===t.selectedGlobalItemId}));e.length&&t.openEditMode(e[0])}}),50)}),(function(){t.isBusy=!1}))}))},e.prototype.initTable=function(t,e){var n=this;return void 0===t&&(t={}),this._tableOptions=Object.assign({},this._tableOptions,t||{}),this.isBusy=!1,e?m.Observable.create((function(t){n.isBusy=!1,n._diTable.initDataTable(n._tableOptions).subscribe((function(e){n._dt=e,t.next(n._dt),t.complete()}))})):(this._diTable.initDataTable(this._tableOptions).subscribe((function(t){n._dt=t})),!0)},e.prototype.getSiteLanguages=function(){var t=this;this._cmn.getSiteLanguages(this._currentSiteId).subscribe((function(e){t.siteLanguages=[],e.map((function(e){e.is_active&&t.siteLanguages.push({name:e.name,code:e.code,main:e.pivot.is_main||!1,current:!1})})),t.currentLang=t.siteLanguages[0].code,t.currentLangName=t.siteLanguages[0].name,t.loadGlobalItems()}),(function(){t.siteLanguages=[{name:"English",code:"en",main:!0,current:!0}],t.loadGlobalItems()}))},e.prototype.openEditMode=function(t){var e=this;this.isBusy=!0;var n={message:"message.get_data_failed",type:r.k.ERROR},i=Object.assign({},o.a.url.globalItem.getOptionsById);i.url=i.url.replace(/(:id)/g,t.id),this._req.doRequest(i).subscribe((function(i){e._propItemList=Object.assign([],i.data),e._cmn.setInfo({navList:[],pageTitle:t.name}),e._propItemList.length>0?e.contentTransEditorCmp.initComponent({propertyList:e._propItemList,moduleType:"global",siteLanguages:e.siteLanguages,itemVarName:t.variable_name}):(n.message="message.no_global_item_options",n.type=r.k.NORMAL,e._sncBar.open(n),e.isBusy=!1)}),(function(){e.isBusy=!1,e._propItemList=[],e._sncBar.open(n),e._cmn.setInfo({navList:[],pageTitle:"app_nav.global_item"})}))},e.prototype.onEditModeReady=function(){$(".component-wrapper").scrollTop(0),this._editMode=!0,this.isBusy=!1,setTimeout((function(){$(".page-detail-wrapper").addClass("hidden")}),500)},e.prototype.closeEditMode=function(){var t=this;this.backToPageId?this._router.navigate(["page-content/"+this.backToPageId]):($(".page-detail-wrapper").removeClass("hidden"),setTimeout((function(){t._editMode=!1,t._pageItemDetail=null,t._cmn.setInfo({topBarButtonList:[],navList:[],pageTitle:"app_nav.global_item"})}),10))},e.prototype.tableEventBinding=function(t){var e=this;t.find('.table-item-icon[aria-function^="edit-"]').off("click.cms-event").on("click.cms-event",(function(t){e._zone.run((function(){var n=($(t.currentTarget).data("item-id"),e._dt.row($(t.currentTarget).closest("tr")).data());e.openEditMode(n)}))}))},e.prototype.afterInitTable=function(t){this.tableEventBinding(t)},i.b([n.i(a._15)(p.a),i.c("design:type",p.a)],e.prototype,"_diTable",void 0),i.b([n.i(a._15)(g.a),i.c("design:type",g.a)],e.prototype,"contentTransEditorCmp",void 0),i.b([n.i(a._16)(l.a),i.c("design:type",a._17)],e.prototype,"diTextEditor",void 0),e=i.b([n.i(a._14)({selector:"[cmp-global-content-list]",template:n(1005)}),i.c("design:paramtypes",[a.h,d.d,a.M,d.c,a.k,b.a,_.d])],e)})(s.a)},974:function(t,e,n){"use strict";var i=n(4),a=n(2),o=n(951),s=n(120),r=n(119),l=n(953),c=n(67),d=n(424),u=n(170),p=n(92),m=n(168);n.d(e,"a",(function(){return g}));var g=(function(t){function e(e){var n=t.call(this,e)||this;return n._pageTitle="Globals",n}return i.a(e,t),e.prototype.ngOnInit=function(){},e=i.b([n.i(a._14)({selector:"[cmp-globals-content]",template:n(952),entryComponents:[s.a,r.a,l.a,c.a,u.a,d.a,p.a,m.a]}),i.c("design:paramtypes",[a.h])],e)})(o.a)},984:function(t,e,n){"use strict";var i=n(4),a=n(2),o=n(26),s=n(985),r=n(974),l=n(953),c=n(421);n.d(e,"a",(function(){return d}));var d=(function(){function t(){}return t.routes=s.a,t=i.b([n.i(a.z)({declarations:[r.a,l.a],imports:[c.a,o.a.forChild(s.a)]})],t)})()},985:function(t,e,n){"use strict";var i=n(974),a=n(953);n.d(e,"a",(function(){return o}));var o=[{path:"",component:i.a,children:[{path:"",component:a.a}]}]}});